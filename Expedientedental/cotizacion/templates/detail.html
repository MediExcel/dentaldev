{% extends "base1.html" %}
{%load static from staticfiles %}
{% load crispy_forms_tags %}
{% block content %}

<div class="well odontograma clearfix">
  <div class="col-xs-3">
    <img src="{% static cotizacion.paciente.imagen %}" alt="{{ cotizacion.paciente.nombre }} {{ cotizacion.paciente.apellidoPaterno }}" class="pull-left img-rounded">
  </div>
  <div class="col-xs-9">
    <table class="table">
      <thead>
        <tr>
          <th>Nombre</th>          
          <th>Grupo</th>
          <th># Cotizaci&oacute;n</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ cotizacion.paciente}}</td>
          <td>{{ cotizacion.paciente.grupo }}</td>
          <td>{{ cotizacion.id}}</td>
        </tr>
      </tbody>
      <thead>
        <tr>
        	<th>Medico Tratante</th>
        	<th>&nbsp;</th>
        	<th>&nbsp;</th>
        </tr>
        <tr>
        	<td>{{ cotizacion.medico }}</td>
        	<td>&nbsp;</td>
        	<td>&nbsp;</td>        	
        </tr>
      </thead>
    </table>
  </div>
</div><!-- patient info section -->



	<h2><class="page-header">Presupuesto de Paciente</h2>

	<form action="{{request.path}}" method="post" >
		{% csrf_token %}

		{{form.as_ul}}
		<input style="float:right; margin-top:10px;" type="submit" value="Guardar cotizacion">
		
		<div class="cleared"></div>
	</form>

	<br><br>


<!---   Para agregar Servicios rapidamente al momento de Registrar al Cliente -->


	<h3>Servicios en esta cotizacion</h3>
	{% if latest_list %}

			<div class="table-responsive">
  			<table class="table table-hover">
 
				<tr>
					
					<th>Pan de Tratamiento</th>			
					<th>Costo</th>					
					<th>Status</th>
				</tr>
			{% for object in latest_list %}

				<ul>
					{% for precio in object_list %}
						

					{% endfor %}
				</ul>

				<tr>
				<form method="POST" action="">
					
					<td><a href="{{request.path}}details/update/{{object.id}}/">{{object.servicio.nombreDelServicio}}</a></td>



					<td><input style="width:55px" type ="text" value ="{{object.servicio.precio}}" class="precio" readonly="precio" ></td>	
					
					<td  class="">{{object.get_estado_display}}</td>
					

				</tr>
			{% endfor %}
				<tr>
					<td></td>
					<td></td>
					<td></td>

					
					
					
					<form method="post" action="">

				</tr>
			</table>


				<table>
					<label style="float:left; margin-left:250px;" for="total">Total:$ <input type="text" id="total" value="0"/ style="text-align:right" style ="width:100px">
				</table>
				<br>
				<br>
			<table border="0" align="right">
					<tr>
						<td style="padding:0px 10px 0px 10px;  "><input  type="button" value="Imprimir" onclick="window.open('{{request.path}}printit')"></td>
						
						<td style="padding:0px 10px 0px 10px;  "><input  type="button" value="Agregar Servicio" onclick="location.href='{{request.path}}details/create/'"></td>
					</tr>
	
					<div class="cleared"></div>
			</table>

			

			




	{% else %}

		<p style="text-align:center;"> No se ha agregado ning√∫n servicio a esta Cotizacion.</p>
					<table border="0" align="right">
					<tr>
						<td style="padding:0px 10px 0px 10px;  "><input  type="button" value="Imprimir" onclick="window.open('{{request.path}}printit')"></td>
						
						<td style="padding:0px 10px 0px 10px;  "><input  type="button" value="Agregar Servicio" onclick="location.href='{{request.path}}details/create/'"></td>
					</tr>
	
					<div class="cleared"></div>
			</table>

	{% endif %}
	
	



{% endblock content %}


 {% block javascript %}
<script type="text/javascript">


function calcular_total() {

	var precio_total = 0;
	$(".precio").each(function(index, value) {
		console.log("Entra a log");
		precio_total = precio_total + parseInt($(this).val());
		console.log(precio_total);
	});
	$("#total").val(precio_total);
}

function obtener() {
	$("#precio").append('<input type="text" class="precio" value="0"');
}
// $("#calcular").on("click",calcular_total());
(function(){
	
	calcular_total();
})();

/*var precio = $('.precio'),
total = $('#precio-total');

$(function(){
total.text(function(){
	var sum = 0;
	precio.each(function(){
		sum += +$(this).text()
	});
	return sum;
});
})(); */

</script>
{% endblock javascript %}


	
