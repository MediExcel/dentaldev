{% extends "base1.html" %}

{% load static from staticfiles %}
{% load crispy_forms_tags %}

{% block css %}
<link rel="stylesheet" href="{%static 'css/jquery-ui-1.8.17.custom.css' %}">

<style>
  .hidden {
    display: none;
  }
</style>

<script src="{% static 'js/modernizr-2.0.6.min.js' %}"></script>
{% endblock %}

{% block content %}

<h2>Odontograma</h2>

<div class="well odontograma clearfix">
  <div class="col-xs-3">
    <img src="{% static paciente.imagen %}" alt="{{ paciente.nombre }} {{ paciente.apellidoPaterno }}" class="pull-left img-rounded">
  </div>
  <div class="col-xs-9">
    <table class="table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Grupo</th>
          <th>Tel√©fono</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ paciente.nombre }} {{ paciente.apellidoPaterno }} {{ paciente.apellidoMaterno }}</td>
          <td>{{ paciente.grupo }}</td>
          <td>{{ paciente.telefono }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div><!-- patient info section -->

<div class="row">
  <div class="col-md-4">
    <p class="lead">1) Seleccione un tratamiento:</p>
  </div>
  <div class="col-md-8">
    <select name="tratamiento" id="tratamientos" class="form-control" data-bind="value: tratamientoSeleccionado,">
      <option>Seleccione un tratamiento...</option>
      {% for tratamiento in tratamientos %}
      <option value="{{ tratamiento.id }}">{{ tratamiento.codigoTratamiento }} - {{ tratamiento.nombreTratamiento }}</option>
      {% endfor %}
    </select>
  </div>
</div>

<form method="post" action="">
  {{ formset.management_form }}

  <p class="lead">2) Seleccione una pieza:</p>

  <div id="odontograma"></div>
  <div id="tooth-images">
    <!--top -->
    <!-- left-side -->
    <img src="{% static 'img/piezas/18.jpg' %}" alt="18" width="28">
    <img src="{% static 'img/piezas/17.jpg' %}" alt="17" width="28">
    <img src="{% static 'img/piezas/16.jpg' %}" alt="16" width="28">
    <img src="{% static 'img/piezas/15.jpg' %}" alt="15" width="22">
    <img src="{% static 'img/piezas/14.jpg' %}" alt="14" width="22">
    <img src="{% static 'img/piezas/13.jpg' %}" alt="13" width="22">
    <img src="{% static 'img/piezas/12.jpg' %}" alt="12" width="24">
    <img src="{% static 'img/piezas/11.jpg' %}" alt="11" width="28">
    <!-- right-side -->
    <img src="{% static 'img/piezas/21.jpg' %}" alt="21" width="28">
    <img src="{% static 'img/piezas/22.jpg' %}" alt="22" width="24">
    <img src="{% static 'img/piezas/23.jpg' %}" alt="23" width="22">
    <img src="{% static 'img/piezas/24.jpg' %}" alt="24" width="22">
    <img src="{% static 'img/piezas/25.jpg' %}" alt="25" width="22">
    <img src="{% static 'img/piezas/26.jpg' %}" alt="26" width="28">
    <img src="{% static 'img/piezas/27.jpg' %}" alt="27" width="28">
    <img src="{% static 'img/piezas/28.jpg' %}" alt="28" width="28">
    <br>
    <!-- bottom -->
    <div class="bottom">
      <!-- left-side -->
      <img src="{% static 'img/piezas/48.jpg' %}" alt="48" width="28">
      <img src="{% static 'img/piezas/47.jpg' %}" alt="47" width="28">
      <img src="{% static 'img/piezas/46.jpg' %}" alt="46" width="28">
      <img src="{% static 'img/piezas/45.jpg' %}" alt="45" width="20">
      <img src="{% static 'img/piezas/44.jpg' %}" alt="44" width="20">
      <img src="{% static 'img/piezas/43.jpg' %}" alt="43" width="20">
      <img src="{% static 'img/piezas/42.jpg' %}" alt="42" width="20">
      <img src="{% static 'img/piezas/41.jpg' %}" alt="41" width="20">
      <!-- right-side -->
      <img src="{% static 'img/piezas/31.jpg' %}" alt="31" width="20">
      <img src="{% static 'img/piezas/32.jpg' %}" alt="32" width="20">
      <img src="{% static 'img/piezas/33.jpg' %}" alt="33" width="20">
      <img src="{% static 'img/piezas/34.jpg' %}" alt="34" width="20">
      <img src="{% static 'img/piezas/35.jpg' %}" alt="35" width="20">
      <img src="{% static 'img/piezas/36.jpg' %}" alt="36" width="28">
      <img src="{% static 'img/piezas/37.jpg' %}" alt="37" width="28">
      <img src="{% static 'img/piezas/38.jpg' %}" alt="38" width="28">
    </div>
  </div>

  <p class="lead">3) Verifique detalles:</p>
  <div class="clearfix">
    <ul data-bind="foreach: tratamientosAplicados">
      <li>
        {% for procedimientoForm in formset %}
        <div class="form-inline">
          {% crispy procedimientoForm %}
        </div>
        {%endfor%}
        <a href="#" data-bind="click: $parent.quitarTratamiento" class="pull-left btn btn-warning">Eliminar</a>
      </li>
    </ul><!-- end foreach -->
  </div>

  <h3 class="page-header">Detalle informaci&oacute;n adicional</h3>

  {% crispy form %}

</form>
{% endblock %}

{% block javascript %}
<script src="{% static 'js/plugins.js'%}"></script>
<script src="{% static 'js/jquery-ui-1.8.17.custom.min.js'%}"></script>
<script src="{% static 'js/jquery.tmpl.js'%}"></script>
<script src="{% static 'js/knockout-3.3.0.js'%}"></script>
<script src="{% static 'js/jquery.svg.min.js'%}"></script>  
<script src="{% static 'js/jquery.svggraph.min.js'%}"></script>  
<script src="{% static 'js/odontograma.js'%}"></script>
<script src="{% static 'js/jquery.formset.js' %}"></script>
<script>
  // some widgets and such
  $(function() {
    var submitButton = $('#odontograma ~ .buttonHolder input'),
        pacienteId = '{{ paciente.id }}',
        pacienteSelect = $('#id_paciente');

    // aligns the submit button
    submitButton.addClass(' pull-right odontograma-submit');

    // gives a value to the paciente field
    pacienteSelect.val(pacienteId);

    // hides paciente field
    $('#div_id_paciente').addClass(' hidden');

    // for saving multiple forms
    $('.form-inline fieldset').formset();
  })();
</script>
{% endblock %}
